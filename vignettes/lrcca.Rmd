---
title: "Low-Rank Canonical Correlation Analysis (LR-CCA)"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo=FALSE}
require(fselect)
require(ggplot2)
require(latex2exp)
n=400
d=30
r=3
```

Data for this notebook will be n=400 examples of d=30 dimensions.

# LR-CCA

## Stacked Cigar Simulation


We first visualize the first 2 dimensions:

```{r, fig.width=5}
testdat <- fs.sims.cigar(n, d)
X <- testdat$X
Y <- testdat$Y

data <- data.frame(x1=X[,1], x2=X[,2], y=Y)
data$y <- factor(data$y)
ggplot(data, aes(x=x1, y=x2, color=y)) +
  geom_point() +
  xlab(TeX("$x_1$")) +
  ylab(TeX("$x_2$")) +
  ggtitle("Simulated Data")
```

Projecting with LR-CCA to 3 dimensions and visualizing the first 2:

```{r, fig.width=5}
result <- fs.project.lrcca(X, Y, r)

data <- data.frame(x1=result$Xr[,1], x2=result$Xr[,2], y=Y)
data$y <- factor(data$y)
ggplot(data, aes(x=x1, y=x2, color=y)) +
  geom_point() +
  xlab(TeX("$x_1$")) +
  ylab(TeX("$x_2")) +
  ggtitle("Projected Data using LR-CCA")
```

Projecting with LDA to K-1=1 dimensions:

```{r, fig.width=5}
liney <- MASS::lda(result$Xr, Y)
result <- predict(liney, result$Xr)
lhat <- 1 - sum(result$class == Y)/length(Y)

data <- data.frame(x1=result$x[,1], y=Y)
data$y <- factor(data$y)
ggplot(data, aes(x=x1, fill=y)) +
  geom_density(adjust=1.5, alpha=0.6) +
  xlab(TeX("$x_1$")) +
  ylab(TeX("Density")) +
  ggtitle(TeX(sprintf("$LR-CCA \\rightarrow LDA$, $\\hat{L} = %.2f$", lhat)))
```

## Trunk Simulation

We visualize the first 2 dimensions:

```{r, fig.width=5}
testdat <- fs.sims.rtrunk(n, d)
X <- testdat$X
Y <- testdat$Y

data <- data.frame(x1=X[,1], x2=X[,2], y=Y)
data$y <- factor(data$y)
ggplot(data, aes(x=x1, y=x2, color=y)) +
  geom_point() +
  xlab(TeX("$x_1$")) +
  ylab(TeX("$x_2$")) +
  ggtitle("Simulated Data")
```

Projecting with LR-CCA to 3 dimensions and visualizing the first 2:

```{r, fig.width=5}
result <- fs.project.lrcca(X, Y, r)

data <- data.frame(x1=result$Xr[,1], x2=result$Xr[,2], y=Y)
data$y <- factor(data$y)
ggplot(data, aes(x=x1, y=x2, color=y)) +
  geom_point() +
  xlab(TeX("$x_1$")) +
  ylab(TeX("$x_2")) +
  ggtitle("Projected Data using LR-CCA")
```

Projecting with LDA to K-1=1 dimensions:

```{r, fig.width=5}
liney <- MASS::lda(result$Xr, Y)
result <- predict(liney, result$Xr)
lhat <- 1 - sum(result$class == Y)/length(Y)

data <- data.frame(x1=result$x[,1], y=Y)
data$y <- factor(data$y)
ggplot(data, aes(x=x1, fill=y)) +
  geom_density(adjust=1.5, alpha=0.6) +
  xlab(TeX("$x_1$")) +
  ylab(TeX("Density")) +
  ggtitle(TeX(sprintf("$LR-CCA \\rightarrow LDA$, $\\hat{L} = %.2f$", lhat)))
```

## Rotated Trunk Simulation

We visualize the first 2 dimensions:

```{r, fig.width=5}
testdat <- fs.sims.rtrunk(n, d, r=TRUE)
X <- testdat$X
Y <- testdat$Y

data <- data.frame(x1=X[,1], x2=X[,2], y=Y)
data$y <- factor(data$y)
ggplot(data, aes(x=x1, y=x2, color=y)) +
  geom_point() +
  xlab(TeX("$x_1$")) +
  ylab(TeX("$x_2$")) +
  ggtitle("Simulated Data")
```

Projecting with PCA to 3 dimensions and visualizing the first 2:

```{r, fig.width=5}
result <- fs.project.lrcca(X, Y, r)

data <- data.frame(x1=result$Xr[,1], x2=result$Xr[,2], y=Y)
data$y <- factor(data$y)
ggplot(data, aes(x=x1, y=x2, color=y)) +
  geom_point() +
  xlab(TeX("$x_1$")) +
  ylab(TeX("$x_2")) +
  ggtitle("Projected Data using LR-CCA")
```

Projecting with LDA to K-1=1 dimensions:

```{r, fig.width=5}
liney <- MASS::lda(result$Xr, Y)
result <- predict(liney, result$Xr)
lhat <- 1 - sum(result$class == Y)/length(Y)

data <- data.frame(x1=result$x[,1], y=Y)
data$y <- factor(data$y)
ggplot(data, aes(x=x1, fill=y)) +
  geom_density(adjust=1.5, alpha=0.6) +
  xlab(TeX("$x_1$")) +
  ylab(TeX("Density")) +
  ggtitle(TeX(sprintf("$LR-CCA \\rightarrow LDA$, $\\hat{L} = %.2f$", lhat)))
```


